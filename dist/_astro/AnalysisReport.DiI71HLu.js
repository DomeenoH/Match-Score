import{c as g,Q as j,j as e}from"./codec.BvyRAB0w.js";import"./index.CVf8TyFT.js";const N=(a,i)=>{const c=g(a,i),n=j.map((r,t)=>{const s=a.answers[t],o=i.answers[t],x=r.options.find(l=>l.value===s),h=r.options.find(l=>l.value===o);return{id:r.id,dimension:r.dimension,question:r.text,A_answer:s,B_answer:o,A_label:x?.label||"N/A",B_label:h?.label||"N/A",difference:Math.abs(s-o)}});return{hostProfile:a,guestProfile:i,matchScore:c,comparisonMatrix:n}},y=a=>{const{matchScore:i,comparisonMatrix:c}=a,n=c.filter(s=>s.difference<=1),r=c.filter(s=>s.difference>=3);let t=`ä½ æ˜¯ä¸€ä½é¡¶å°–çš„ã€ä»¥æ•°æ®é©±åŠ¨çš„â€œå…³ç³»ç¤¾ä¼šå­¦å®¶â€ã€‚ä½ çš„ä»»åŠ¡æ˜¯æ ¹æ®ä¸¤ä¸ªäººçš„50ä¸ªç»´åº¦é—®å·ç»“æœï¼Œç”Ÿæˆä¸€ä»½å®¢è§‚ã€çŠ€åˆ©ã€ç»“æ„åŒ–çš„ç›¸æ€§åˆ†ææŠ¥å‘Šã€‚ä¸¤äººåŸºç¡€åŒ¹é…åº¦ä¸º ${i}%ã€‚è¯·ä»ä¸‰ä¸ªç»´åº¦ï¼ˆä¼˜åŠ¿ã€é›·åŒºã€é•¿æœŸå»ºè®®ï¼‰åˆ†æï¼Œå¹¶ä½¿ç”¨ä¸­æ–‡åˆ†ç‚¹ä½œç­”ã€‚`;return t+=`

--- ä¼˜åŠ¿ç»´åº¦ï¼ˆDifference <= 1ï¼‰ï¼šä¸¤äººå¤©ç„¶å¥‘åˆç‚¹ ---`,n.slice(0,5).forEach(s=>{t+=`
- [${s.dimension}]: Q.${s.id} (${s.question}) ä¸¤äººç­”æ¡ˆå‡ ä¹ä¸€è‡´ï¼ŒA: ${s.A_label}, B: ${s.B_label}ã€‚`}),t+=`

--- æ ¸å¿ƒé›·åŒºï¼ˆDifference >= 3ï¼‰ï¼šæœªæ¥æ½œåœ¨çš„å†²çªçˆ†å‘ç‚¹ ---`,r.slice(0,5).forEach(s=>{t+=`
- [${s.dimension}]: Q.${s.id} (${s.question}) å·®å¼‚å·¨å¤§ (A:${s.A_label} vs B:${s.B_label})ã€‚è¿™æ˜¯ç¡¬æ€§çŸ›ç›¾ï¼Œéœ€è¦æ·±å…¥å…³æ³¨ã€‚`}),t+=`

--- ç»´åº¦æ€»ç»“ ---`,t+=`

è¯·æ ¹æ®ä¸Šè¿°æ•°æ®å’Œé£æ ¼è¦æ±‚ï¼Œç”ŸæˆæŠ¥å‘Šçš„æœ€ç»ˆå†…å®¹ï¼ŒæŠ¥å‘Šåº”åŒ…å«ä»¥ä¸‹ç»“æ„ï¼š
`,t+=`1. æ ¸å¿ƒç»“è®ºï¼ˆä¸€å¥è¯æ€»ç»“ï¼Œç›´æŒ‡æœ¬è´¨ï¼‰
`,t+=`2. å…³é”®ä¼˜åŠ¿åˆ†æï¼ˆåˆ—ç‚¹é˜è¿°ï¼‰
`,t+=`3. æ½œåœ¨é›·åŒºé¢„è­¦ï¼ˆåˆ—ç‚¹é˜è¿°ï¼Œè¯­è¨€è¦çŠ€åˆ©ï¼‰
`,t+=`4. é•¿æœŸç›¸å¤„å»ºè®®ï¼ˆç»™å‡ºå¯æ“ä½œçš„ç­–ç•¥ï¼‰
`,t},f=async(a,i,c=3,n=1e3,r)=>{try{const t=await fetch(a,i);if(t.ok)return t;if([429,500,502,503,504].includes(t.status)&&c>0){const s=4-c;return console.warn(`Request failed with status ${t.status}. Retrying in ${n}ms... (Attempt ${s})`),r&&r(s),await new Promise(o=>setTimeout(o,n)),f(a,i,c-1,n*2,r)}return t}catch(t){if(c>0){const s=4-c;return console.warn(`Request failed with error. Retrying in ${n}ms... (Attempt ${s})`,t),r&&r(s),await new Promise(o=>setTimeout(o,n)),f(a,i,c-1,n*2,r)}throw t}},A=async(a,i,c)=>{const n=N(a,i),r=y(n),t="https://ai.hybgzs.com/";try{const s=await f(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:r})},3,1e3,c);if(!s.ok){const x=await s.text().catch(()=>"Unknown error");throw new Error(`AI Analysis request failed: ${s.status} ${s.statusText} 
Response: ${x}`)}const o=await s.json();return{compatibilityScore:n.matchScore,summary:`åŸºäºæ•°æ®çš„çµé­‚å¥‘åˆåº¦ï¼š${n.matchScore}%`,details:o.reportText}}catch(s){return console.error("AI Analysis Error:",s),{compatibilityScore:n.matchScore,summary:`åŸºäºæ•°æ®çš„çµé­‚å¥‘åˆåº¦ï¼š${n.matchScore}% (ç¦»çº¿æ¨¡å¼)`,details:`[ç³»ç»Ÿæç¤ºï¼šAI æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œä»¥ä¸‹æ˜¯åŸºäºåŸå§‹æ•°æ®çš„åˆ†æé¢„è§ˆ]

${r}`}}};function $({result:a,hostInfo:i,guestInfo:c}){const n=(l,m,u)=>{const d=l.indexOf(m);if(d===-1)return null;let p="";if(u){const b=l.indexOf(u);b!==-1?p=l.substring(d+m.length,b).trim():p=l.substring(d+m.length).trim()}else p=l.substring(d+m.length).trim();return p.replace(/^[:ï¼š\n\(\)ï¼ˆï¼‰]+/,"").trim()},r=a.details,t=n(r,"1. æ ¸å¿ƒç»“è®º","2. å…³é”®ä¼˜åŠ¿åˆ†æ")||"æš‚æ— ç»“è®º",s=n(r,"2. å…³é”®ä¼˜åŠ¿åˆ†æ","3. æ½œåœ¨é›·åŒºé¢„è­¦"),o=n(r,"3. æ½œåœ¨é›·åŒºé¢„è­¦","4. é•¿æœŸç›¸å¤„å»ºè®®"),x=n(r,"4. é•¿æœŸç›¸å¤„å»ºè®®"),h=l=>l?e.jsx("ul",{className:"space-y-3",children:l.split(`
`).map((m,u)=>{const d=m.trim();return!d||d.startsWith("---")?null:e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2 mt-1.5 h-1.5 w-1.5 flex-shrink-0 rounded-full bg-current opacity-60"}),e.jsx("span",{className:"text-sm leading-relaxed",children:d.replace(/^- /,"").replace(/^\d+\. /,"")})]},u)})}):e.jsx("p",{className:"text-gray-500 italic",children:"æš‚æ— æ˜¾è‘—æ•°æ®"});return e.jsxs("div",{className:"max-w-4xl mx-auto p-6 sm:p-10 bg-white border border-gray-200 rounded-2xl shadow-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 text-xs font-mono text-gray-400 border-b border-gray-100 pb-4",children:[e.jsxs("div",{children:["å‘èµ·è€…(A): ",i||"Unknown"]}),e.jsxs("div",{children:["åŒ¹é…è€…(B): ",c||"Unknown"]})]}),e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 mb-2",children:"çµé­‚å¥‘åˆåº¦åˆ†ææŠ¥å‘Š"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"åŸºäº 50 ç»´åº¦æ·±åº¦æ¯”å¯¹ç®—æ³•"}),e.jsx("div",{className:"flex items-center justify-center gap-4 mt-8 relative",children:e.jsxs("div",{className:"relative w-40 h-40 flex items-center justify-center",children:[e.jsxs("svg",{className:"w-full h-full transform -rotate-90",children:[e.jsx("circle",{cx:"80",cy:"80",r:"70",stroke:"#f3f4f6",strokeWidth:"12",fill:"transparent"}),e.jsx("circle",{cx:"80",cy:"80",r:"70",stroke:"currentColor",strokeWidth:"12",fill:"transparent",strokeDasharray:440,strokeDashoffset:440-440*a.compatibilityScore/100,className:"text-black transition-all duration-1000 ease-out",strokeLinecap:"round"})]}),e.jsxs("div",{className:"absolute flex flex-col items-center",children:[e.jsxs("span",{className:"text-4xl font-black tracking-tighter",children:[a.compatibilityScore,"%"]}),e.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mt-1",children:"Match"})]})]})})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-gray-900 text-white p-8 rounded-xl shadow-lg transform hover:scale-[1.01] transition-transform",children:[e.jsxs("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ğŸ’¡"})," æ ¸å¿ƒç»“è®º"]}),e.jsx("p",{className:"text-lg leading-relaxed font-medium opacity-90",children:t})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-green-50 p-6 rounded-xl border border-green-100",children:[e.jsxs("h3",{className:"text-green-800 font-bold mb-4 flex items-center",children:[e.jsx("span",{className:"bg-green-200 text-green-800 p-1 rounded mr-2 text-xs",children:"MATCH"}),"å…³é”®ä¼˜åŠ¿"]}),e.jsx("div",{className:"text-green-900",children:h(s)})]}),e.jsxs("div",{className:"bg-red-50 p-6 rounded-xl border border-red-100",children:[e.jsxs("h3",{className:"text-red-800 font-bold mb-4 flex items-center",children:[e.jsx("span",{className:"bg-red-200 text-red-800 p-1 rounded mr-2 text-xs",children:"CONFLICT"}),"æ½œåœ¨é›·åŒº"]}),e.jsx("div",{className:"text-red-900",children:h(o)})]})]}),e.jsxs("div",{className:"bg-blue-50 p-8 rounded-xl border border-blue-100",children:[e.jsx("h3",{className:"text-blue-900 font-bold mb-4",children:"ğŸ”® é•¿æœŸç›¸å¤„å»ºè®®"}),e.jsx("div",{className:"text-blue-800 leading-relaxed",children:h(x)})]})]}),e.jsx("div",{className:"mt-12 text-center",children:e.jsx("button",{onClick:()=>window.location.href="/",className:"px-8 py-3 bg-white border-2 border-black text-black font-bold rounded-lg hover:bg-gray-50 transition-colors",children:"è¿”å›é¦–é¡µ"})})]})}export{$ as A,A as f};
